
import React, { useState } from 'react';
import { Link } from 'react-router-dom';
import { BookOpen, Search } from 'lucide-react';
import BookCard from '../components/BookCard';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import MetaTags from '../components/MetaTags';
import { BookType } from '../types/books';

// بيانات الكتب
export const booksData: BookType[] = [
  {
    id: 1,
    title: "أزمة وحلول: مستقبل الحراك الإسلامي في الجزائر",
    author: "الشيخ علي بن حاج",
    cover: "/lovable-uploads/9b70a61d-fdfe-40af-9a1d-bff43338c387.png",
    downloadUrl: "https://example.com/download/crisis-and-solutions.pdf",
    year: "2022",
    publicationDate: "15 رمضان 1443هـ",
    pages: "320",
    description: "يتناول هذا الكتاب تحليلاً عميقاً للأزمات التي واجهت الحركة الإسلامية في الجزائر، ويقدم رؤية استراتيجية للمستقبل مع حلول عملية لتجاوز العقبات.",
    tags: ["فكر سياسي", "حركة إسلامية", "تحليل", "رؤية مستقبلية"],
    fullDescription: "يتناول هذا الكتاب تحليلاً عميقاً للأزمات التي واجهت الحركة الإسلامية في الجزائر، ويقدم رؤية استراتيجية للمستقبل مع حلول عملية لتجاوز العقبات.\n\nيستعرض الكتاب مراحل تطور الحركة الإسلامية في الجزائر منذ نشأتها، والتحديات الكبرى التي واجهتها، ويقدم قراءة نقدية للأخطاء التي ارتكبت، والفرص التي ضاعت، مع تشخيص دقيق للواقع الراهن.\n\nينطلق المؤلف من تجربته الطويلة في العمل الإسلامي، ومعايشته المباشرة للأحداث، ليقدم رؤية متكاملة للنهوض بالعمل الإسلامي في الجزائر، تشمل الجوانب الفكرية والتنظيمية والسياسية والاجتماعية.\n\nيطرح الكتاب مجموعة من الحلول العملية التي تراعي خصوصية المجتمع الجزائري، وتستفيد من التجارب الناجحة في بلدان أخرى، مع التأكيد على ضرورة التجديد في الخطاب والأساليب، ومراجعة المفاهيم والأولويات، وبناء جسور التواصل مع مختلف فئات المجتمع، وخاصة جيل الشباب.\n\nكما يشدد الكتاب على أهمية الوحدة والتعاون بين مختلف التيارات الإسلامية، ونبذ الخلافات الثانوية، والتركيز على القضايا الكبرى التي تهم الأمة، مع الانفتاح على كل القوى الوطنية المخلصة، والعمل المشترك من أجل بناء جزائر قوية ومزدهرة في ظل قيم الإسلام."
  },
  {
    id: 2,
    title: "الجزائر: مستقبل الهوية والتحديات المعاصرة",
    author: "الشيخ علي بن حاج",
    cover: "/lovable-uploads/36396a59-1f0a-4d68-a2ce-0f735612c2cc.png",
    downloadUrl: "https://example.com/download/algeria-identity-future.pdf",
    year: "2020",
    pages: "280",
    description: "يناقش الكتاب قضايا الهوية الوطنية في الجزائر والتحديات التي تواجهها في عصر العولمة، مع التركيز على دور الدين والثقافة في بناء المستقبل المنشود.",
    tags: ["هوية وطنية", "تحديات معاصرة", "إسلام", "ثقافة"],
    fullDescription: "يناقش الكتاب قضايا الهوية الوطنية في الجزائر والتحديات التي تواجهها في عصر العولمة، مع التركيز على دور الدين والثقافة في بناء المستقبل المنشود.\n\nيتناول العمل إشكالية الهوية في الجزائر من منظور تاريخي وفكري، ويستعرض الروافد المختلفة المشكلة للشخصية الجزائرية، والتي تتمثل أساساً في الإسلام والعروبة والأمازيغية، مؤكداً على أن هذه المكونات متكاملة وليست متناقضة، وأن الوعي بها جميعاً ضروري لتحقيق الاستقرار والتقدم.\n\nيحلل الكتاب التحديات المعاصرة التي تواجه الهوية الوطنية، خاصة تأثير العولمة والثورة المعلوماتية، وظاهرة الاستلاب الثقافي، ومحاولات بعض الدوائر الغربية لفرض نموذجها الثقافي والقيمي على المجتمعات الإسلامية.\n\nكما يتطرق إلى قضايا الانفتاح والتجديد وكيفية المواءمة بين الأصالة والمعاصرة، ويشدد على ضرورة إعادة قراءة التراث قراءة واعية، تستلهم روحه ومقاصده، وتستفيد من إنجازات العصر ومنجزاته، دون الانسلاخ عن الهوية والقيم.\n\nويختم الكاتب بوضع رؤية استشرافية لمستقبل الهوية الجزائرية، وسبل تعزيزها وتحصينها، مع التأكيد على دور المؤسسات التربوية والثقافية والإعلامية في هذا المجال، وأهمية التكامل بين جهود الدولة والمجتمع لحماية الهوية الوطنية والدفاع عنها."
  },
  {
    id: 3,
    title: "منهج التغيير: قراءة في سنن التحول الاجتماعي",
    author: "الشيخ علي بن حاج",
    cover: "/lovable-uploads/d1a44ab9-1ce3-4bc1-a6b4-4555f7a29b09.png",
    downloadUrl: "https://example.com/download/methodology-of-change.pdf",
    year: "2018",
    pages: "240",
    description: "يقدم الكتاب رؤية إسلامية شاملة لمنهج التغيير الاجتماعي، مستنداً إلى القرآن والسنة، ومستلهماً من تجارب التاريخ، مع تطبيقات عملية على واقع العالم الإسلامي المعاصر.",
    tags: ["تغيير اجتماعي", "منهج إسلامي", "إصلاح", "سنن التغيير"],
    fullDescription: "يقدم الكتاب رؤية إسلامية شاملة لمنهج التغيير الاجتماعي، مستنداً إلى القرآن والسنة، ومستلهماً من تجارب التاريخ، مع تطبيقات عملية على واقع العالم الإسلامي المعاصر.\n\nينطلق الكتاب من الآية الكريمة: \"إِنَّ اللَّهَ لَا يُغَيِّرُ مَا بِقَوْمٍ حَتَّىٰ يُغَيِّرُوا مَا بِأَنفُسِهِمْ\"، ليؤسس لفهم عميق لسنن التغيير الاجتماعي في ضوء المنظور الإسلامي، الذي يجمع بين عوامل التغيير المادية والمعنوية، ويربط بين حركة الفرد والمجتمع.\n\nيستعرض المؤلف السنن الإلهية في التغيير، مثل سنة التدرج، وسنة المدافعة، وسنة التمكين، وسنة الأسباب والنتائج، ويشرح كيفية توظيفها في عملية الإصلاح والتجديد، مع التحذير من مخالفتها أو تجاهلها.\n\nكما يناقش الكتاب مراحل التغيير ومتطلباته، بدءاً من تغيير الوعي والفكر، مروراً بتغيير القيم والسلوك، وصولاً إلى تغيير النظم والمؤسسات، مع التأكيد على أهمية التوازن والتكامل بين هذه المستويات.\n\nويتطرق إلى العقبات والتحديات التي تواجه عملية التغيير، سواء كانت داخلية أو خارجية، ويقترح آليات وأساليب لمواجهتها والتغلب عليها، مستفيداً من تجارب الحركات الإصلاحية عبر التاريخ.\n\nويختم الكتاب بتقديم رؤية عملية للتغيير في واقع العالم الإسلامي المعاصر، تأخذ بعين الاعتبار خصوصياته وتحدياته، مع التركيز على دور الشباب والمثقفين والعلماء في قيادة عملية التغيير وترشيدها."
  },
  {
    id: 4,
    title: "فصل التخالف في قضية التحالف",
    author: "الشيخ علي بن حاج",
    cover: "/lovable-uploads/0b5b4808-4d98-4f13-b56d-488ec6e0da87.png",
    downloadUrl: "https://archive.org/download/20250327_20250327_0839/%D9%81%D8%B5%D9%84%20%D8%A7%D9%84%D8%AA%D8%AE%D8%A7%D9%84%D9%81%20%D9%81%D9%8A%20%D9%82%D8%B6%D9%8A%D8%A9%20%D8%A7%D9%84%D8%AA%D8%AD%D8%A7%D9%84%D9%81.pdf",
    year: "1993",
    publicationDate: "1414هـ / 1993م",
    pages: "64",
    description: "رسالة مختصرة تتناول مسألة التحالف بين الجماعات الإسلامية وغيرها من الجهات أو الأحزاب، وتعرض لمفهوم الحلف في اللغة وفي الشريعة.",
    tags: ["فكر إسلامي", "عمل سياسي", "شرعية", "تحالف"],
    fullDescription: "فصل التخالف في قضية التحالف هي رسالة مختصرة كتبها الشيخ أبو عبد الفتاح علي بن حاج، نُشرت أول مرة على صفحات جريدة المنقذ الناطقة باسم الجبهة الإسلامية للإنقاذ، في عددها رقم 27 بتاريخ 15 ربيع الأول 1411 هـ / الموافق لـ 4 أكتوبر 1990 م، ثم أعيد طبعها في طبعة أولى سنة 1993م / 1414هـ عن دار العقاب.\n\nتتناول الرسالة مسألة \"التحالف\" بين الجماعات الإسلامية وغيرها من الجهات أو الأحزاب، وتعرض لمفهوم الحلف في اللغة وفي الشريعة، وتناقش بالتفصيل الأحاديث النبوية الواردة في شأن الحلف، وأقوال العلماء حول نسخه أو استمراره، مع بيان مواقف الصحابة، وأمثلة من أحلاف الجاهلية، لا سيما حلف الفضول، الذي شهد عليه النبي صلى الله عليه وسلم قبل البعثة، وعبّر لاحقًا عن استعداده للمشاركة فيه حتى بعد الإسلام، لو دُعي إليه.\n\nتستعرض الرسالة خلاف العلماء حول قول النبي ﷺ: \"لا حلف في الإسلام\"، وتوضح أن هناك من يرى أن هذا النفي خاص بنوع معين من الأحلاف مثل أحلاف التوارث أو الحروب القبلية، في حين يرى آخرون أنه نفيٌ عام يشمل كل تحالف مخصص خارج إطار أخوة الإيمان الجامعة.\n\nيؤكد الشيخ في الرسالة أن نصرة المظلوم، والأخذ على يد الظالم، والتعاون على البر والتقوى، لا تفتقر إلى تحالفات خاصة أو مواثيق إضافية، لأنها مفروضة أصلًا على المسلمين بنصوص الكتاب والسنة. ويعتبر أن المؤاخاة الإيمانية التي عقدها الله ورسوله كافية وشاملة لكل أنواع التعاون والنصرة المشروعة، ولا حاجة لعقود تحالف قد تنزلق في كثير من الأحيان إلى التكتلات الحزبية أو الولاءات الضيقة.\n\nوفي خلاصة الرسالة، يدعو الشيخ إلى أن يكون المسلمون يدًا واحدة على من عاداهم، وإلى تجاوز الخلافات الجانبية التي لا تمس أصول العقيدة، مكررًا أن التآلف بين الأرواح لا يحتاج إلى تحالفات موقعة بين الأشباح. ويختم برسالة اعتذار واضح، يؤكد فيها أنه يتناول المسألة من زاوية فكرية شرعية، دون التطرق لأسماء أو هيئات، مراعاة لأدب الاختلاف، وحرصًا على وحدة الصف الإسلامي.\n\nالرسالة تُعدّ واحدة من سلسلة منشورات الشيخ علي بن حاج الفكرية والتنبيهية، تضم عناوين مثل: الدمغة القوية لنسف عقيدة الديمقراطية، وإجادة التحبير في بيان قواعد التغيير، وتنبيه الأخيار إلى حكم الاستعانة بالكفار. وهي رسائل موجّهة إلى جمهور الصحوة الإسلامية، تُقدَّم بلغة شرعية مباشرة، تضع \"الشرع\" معيارًا لكل تعامل سياسي أو تنظيمي."
  }
];

const Books = () => {
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedTag, setSelectedTag] = useState<string | null>(null);
  
  // استخراج كل التاغات من جميع الكتب بدون تكرار
  const allTags = Array.from(
    new Set(booksData.flatMap(book => book.tags))
  );
  
  // تصفية الكتب حسب البحث والتاغ المحدد
  const filteredBooks = booksData.filter(book => {
    const matchesSearch = searchQuery === '' || 
      book.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
      book.description.toLowerCase().includes(searchQuery.toLowerCase());
    
    const matchesTag = selectedTag === null || book.tags.includes(selectedTag);
    
    return matchesSearch && matchesTag;
  });
  
  return (
    <div className="min-h-screen">
      {/* Meta Tags */}
      <MetaTags statement={undefined} isStatementPage={false} />
      
      {/* Hero Section */}
      <div className="bg-navy py-20 relative">
        <div className="absolute inset-0 bg-pattern opacity-5"></div>
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
          <div className="text-center">
            <h1 className="text-4xl font-bold text-white mb-4">مكتبة الشيخ علي بن حاج</h1>
            <p className="text-xl text-gray-200 max-w-3xl mx-auto">
              مجموعة من الكتب والمؤلفات التي تناقش قضايا العقيدة والفكر والسياسة من منظور إسلامي
            </p>
          </div>
        </div>
      </div>
      
      {/* Search and Filter Section */}
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
          <div className="relative w-full md:w-auto">
            <Input
              placeholder="ابحث عن كتاب..."
              className="pl-10 w-full md:w-80"
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
            />
            <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={18} />
          </div>
          
          <div className="flex flex-wrap gap-2">
            <Button
              variant={selectedTag === null ? "default" : "outline"}
              onClick={() => setSelectedTag(null)}
              size="sm"
            >
              الكل
            </Button>
            {allTags.map(tag => (
              <Button
                key={tag}
                variant={selectedTag === tag ? "default" : "outline"}
                onClick={() => setSelectedTag(tag)}
                size="sm"
              >
                {tag}
              </Button>
            ))}
          </div>
        </div>
        
        {/* Books Grid */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {filteredBooks.length > 0 ? (
            filteredBooks.map(book => (
              <BookCard 
                key={book.id}
                id={book.id}
                title={book.title}
                cover={book.cover}
                year={book.year}
                publicationDate={book.publicationDate}
                pages={book.pages}
                description={book.description}
              />
            ))
          ) : (
            <div className="col-span-full text-center py-12">
              <BookOpen size={48} className="mx-auto text-gray-300 mb-4" />
              <h3 className="text-xl font-bold text-gray-700 mb-2">لم يتم العثور على كتب</h3>
              <p className="text-gray-500">
                لا توجد نتائج تطابق معايير البحث. يرجى تجربة كلمات مفتاحية أخرى أو إزالة الفلتر.
              </p>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default Books;
